---
// Closing CTA with lead form
---

<section class="section bg-brand-navy text-white">
  <div class="container">
    <div class="grid gap-12 lg:grid-cols-2 lg:items-center">
      <!-- Content -->
      <div class="stack-sm">
        <span class="eyebrow text-brand-gold">Get Started Today</span>
        <h2 class="text-balance">Ready to Transform Your Bookkeeping?</h2>
        <p class="text-body-lg text-white/80">
          Join hundreds of Texas businesses that have streamlined their finances with Modern Ledger.
          Schedule your free consultation and see the difference professional bookkeeping can make.
        </p>
        <div class="flex flex-wrap gap-4 text-sm text-white/70">
          <div class="flex items-center gap-2">
            <svg class="h-5 w-5 text-brand-gold" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            Free 30-minute consultation
          </div>
          <div class="flex items-center gap-2">
            <svg class="h-5 w-5 text-brand-gold" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            No obligation assessment
          </div>
          <div class="flex items-center gap-2">
            <svg class="h-5 w-5 text-brand-gold" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            Custom pricing proposal
          </div>
        </div>
      </div>

      <!-- Form -->
      <div class="surface bg-white p-8 rounded-2xl shadow-elevation">
        <div class="mb-6">
          <h3 class="text-2xl font-semibold text-brand-navy mb-2">Schedule Your Free Consultation</h3>
          <p class="text-neutral-600">Fill out the form below and we'll get back to you within 24 hours.</p>
        </div>

        <form id="closing-cta-form" class="space-y-4">
          <div class="grid gap-4 md:grid-cols-2">
            <div>
              <label for="first-name" class="block text-sm font-medium text-neutral-700 mb-1">First Name *</label>
              <input
                type="text"
                id="first-name"
                name="firstName"
                required
                class="w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-brand-gold"
                placeholder="John"
              />
            </div>
            <div>
              <label for="last-name" class="block text-sm font-medium text-neutral-700 mb-1">Last Name *</label>
              <input
                type="text"
                id="last-name"
                name="lastName"
                required
                class="w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-brand-gold"
                placeholder="Doe"
              />
            </div>
          </div>

          <div>
            <label for="email" class="block text-sm font-medium text-neutral-700 mb-1">Email *</label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-brand-gold"
              placeholder="john@company.com"
            />
          </div>

          <div>
            <label for="phone" class="block text-sm font-medium text-neutral-700 mb-1">Phone</label>
            <input
              type="tel"
              id="phone"
              name="phone"
              class="w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-brand-gold"
              placeholder="(555) 123-4567"
            />
          </div>

          <div>
            <label for="message" class="block text-sm font-medium text-neutral-700 mb-1">Message</label>
            <textarea
              id="message"
              name="message"
              rows={4}
              class="w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-brand-gold"
              placeholder="Tell us about your bookkeeping needs..."
            ></textarea>
          </div>

          <button
            type="submit"
            class="w-full bg-brand-navy text-white py-3 px-4 rounded-md font-semibold hover:bg-brand-navy-dark focus:outline-none focus:ring-2 focus:ring-brand-gold focus:ring-offset-2 transition-colors"
          >
            Schedule Consultation
          </button>
        </form>

        <p class="mt-4 text-xs text-neutral-500 text-center">
          By submitting this form, you agree to our privacy policy and terms of service.
        </p>
      </div>
    </div>
  </div>
</section>

<script>
  document.getElementById('closing-cta-form')?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const form = e.target as HTMLFormElement;
    const formData = new FormData(form);

    const payload = {
      name: `${formData.get('firstName')} ${formData.get('lastName')}`.trim(),
      email: formData.get('email'),
      phone: formData.get('phone') || undefined,
      message: formData.get('message') || 'Interested in scheduling a free consultation',
      sourcePage: 'homepage-closing-cta'
    };

    try {
      const response = await fetch('/api/forms/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      if (response.ok) {
        // Track lead form submission
        if (typeof window !== 'undefined' && (window as any).analytics?.trackLeadSubmit) {
          (window as any).analytics.trackLeadSubmit('closing-cta-form', window.location.pathname);
        }
        alert('Thank you! We\'ll be in touch within 24 hours to schedule your consultation.');
        form.reset();
      } else {
        alert('Something went wrong. Please try again or contact us directly.');
      }
    } catch (error) {
      alert('Something went wrong. Please try again or contact us directly.');
    }
  });
</script>